# -*- coding: utf-8 -*-
"""sonar prediction (rock vs mine).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1uVtMDnHm3KZcLCKGe_hBvEnwM2-SfTbx
"""

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

sonar_data = pd.read_csv('/content/Copy of sonar data.csv', header=None)

sonar_data.head(10)

sonar_data.shape

sonar_data.describe()

sonar_data[60].value_counts() # m = mine , R = rock

sonar_data.groupby(60).mean() #mean value

x = sonar_data.drop(columns=60, axis=1)
y = sonar_data[60]

print(x)
print(y)

x_train, x_test, y_train, y_test = train_test_split(x, y,  test_size = 0.1, stratify=y, random_state=1)

print(x.shape, x_train.shape, x_test.shape)

print(x_train)
print(y_train)

model = LogisticRegression()

model.fit(x_train, y_train)

#accuracy on training data
X_train_prediction = model.predict(x_train)
training_data_accuracy = accuracy_score(X_train_prediction, y_train)

print('accuracy on training data ; ', training_data_accuracy)

x_test_prediction = model.predict(x_test) # accurcy of test data
test_data_accuracy = accuracy_score(x_test_prediction, y_test)

print('Accuracy on test data : ', test_data_accuracy)

input_data = (0.0307,0.0523,0.0653,0.0521,0.0611,0.0577,0.0665,0.0664,0.1460,0.2003,0.1449,0.0886,0.0543,0.0250,0.0210,0.0362,0.0827,0.1264,0.0761,0.0766,0.1587,0.1989,0.2520,0.1947,0.1462,0.1425,0.1593,0.1006,0.0903,0.1345,0.0841,0.0560,0.0163,0.0095,0.0069,0.0049,0.0100,0.0152,0.0044,0.0109,0.0076,0.0089,0.0028,0.0179,0.0100,0.0039,0.0113,0.0029,0.0050,0.0020,0.0003,0.0053,0.0023,0.0019,0.0026,0.0026,0.0037,0.0070,0.0070,0.0066)
# changing the input_data to a numpy array
input_data_as_numpy_array = np.asarray(input_data)
# reshape the np array as we are predicting for one instance
input_data_reshaped = input_data_as_numpy_array.reshape(1,-1)
prediction = model.predict(input_data_reshaped)
print(prediction)
if (prediction[0]=='R'):
  print('The object is a Rock')
else:
  print('The object is a mine')